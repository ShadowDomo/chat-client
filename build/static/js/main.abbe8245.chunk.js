(this["webpackJsonpchat-client"]=this["webpackJsonpchat-client"]||[]).push([[0],{91:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n.n(c),a=n(49),r=n.n(a),o=n(4),i=n(2),j=Object(c.createContext)(null),l=n(1),u=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(""),r=Object(o.a)(a,2),u=r[0],b=r[1],m=Object(o.a)(Object(c.useContext)(j).usernames,2),d=(m[0],m[1]),O=Object(o.a)(Object(c.useContext)(j).room,2),h=(O[0],O[1]),x=Object(i.f)();return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Chat room"}),Object(l.jsxs)("div",{className:"form-group",children:[Object(l.jsx)("label",{className:"",children:"Username"}),Object(l.jsx)("input",{className:"form-control",type:"text",value:n,onChange:function(e){return s(e.target.value)}})]}),Object(l.jsxs)("div",{className:"form-group mt-2",children:[Object(l.jsx)("label",{className:"",children:"Room Code"}),Object(l.jsx)("input",{className:"form-control",type:"text",value:u,onChange:function(e){return b(e.target.value)}})]}),Object(l.jsx)("button",{onClick:function(){d(n),h(u),x.push("/room")},className:"btn btn-primary mt-2",children:"Join room"})]})},b=n(19),m=n(24),d=n(51),O=n.n(d),h=function(e){var t=e.message;return"status"in t?Object(l.jsx)("div",{className:"my-1 rounded py-1 px-2",children:Object(l.jsx)("div",{className:"d-flex justify-content-center",children:Object(l.jsxs)("small",{children:[t.username," ",t.status]})})}):Object(l.jsxs)("div",{className:"border border-secondary my-1 rounded py-1 px-2",children:[Object(l.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(l.jsx)("small",{children:t.username}),Object(l.jsx)("small",{children:new Date(parseInt(t.time)).toLocaleTimeString("en-AU").toString()})]}),Object(l.jsx)("h6",{children:t.content})]})},x=function(){var e=Object(o.a)(Object(c.useContext)(j).usernames,2),t=e[0],n=(e[1],Object(o.a)(Object(c.useContext)(j).room,2)),s=n[0],a=(n[1],Object(c.useState)([])),r=Object(o.a)(a,2),u=r[0],d=r[1],x=Object(c.useState)(""),f=Object(o.a)(x,2),p=f[0],v=f[1],g=Object(c.useState)(null),y=Object(o.a)(g,2),N=y[0],C=y[1],S=Object(c.useState)([]),w=Object(o.a)(S,2),k=w[0],R=w[1],E=Object(i.f)(),I=Object(c.useRef)(null);function J(e){d((function(t){var n=Object(m.a)(t);return n.length>9&&n.shift(),n.push(e),n}))}return Object(c.useEffect)((function(){var e=!0,n=O()("http://chatclient-env.eba-6usxyhmz.ap-southeast-2.elasticbeanstalk.com/");return C(n),""!==t&&""!==s||E.push("/"),e&&(n.emit("joinRoom",{username:t,roomCode:s}),n.on("joinedRoom",(function(e){J(Object(b.a)(Object(b.a)({},e),{},{status:"has joined the room"}))})),n.on("message",(function(e){J(e)})),n.on("disconnected",(function(e){J(Object(b.a)(Object(b.a)({},e),{},{status:"has left the room"}))})),n.on("typingEnded",(function(e){R((function(t){return Object(m.a)(t).filter((function(t){return t!==e.username}))})),console.log("ended")})),n.on("typingStarted",(function(e){console.log(e),R((function(t){return t.includes(e.username)?t:[].concat(Object(m.a)(t),[e.username])}))}))),function(){e=!1,n.disconnect()}}),[t,s]),Object(c.useEffect)((function(){I.current.scrollIntoView({behavior:"smooth"})}),[u]),Object(l.jsxs)("div",{className:"d-flex flex-column h-75 container",children:[Object(l.jsx)("h1",{className:"row",children:"Chat room"}),Object(l.jsxs)("div",{className:"row overflow-auto",style:{maxHeight:"70vh"},children:[u.map((function(e,t){return Object(l.jsx)(h,{message:e},t)})),Object(l.jsx)("div",{ref:I})]}),Object(l.jsxs)("div",{className:"fixed-bottom mb-5 container",children:[Object(l.jsx)("div",{className:"text-center",children:function(){if(0!==k.length)return 1===k.length?Object(l.jsxs)("small",{children:[k.toString()," is typing..."]}):Object(l.jsxs)("small",{children:[k.join(", ")," are typing..."]})}()}),Object(l.jsxs)("div",{className:"form-group d-flex",children:[Object(l.jsx)("input",{type:"text",className:"form-control",placeholder:"Type something...",style:{marginRight:"15px"},value:p,onChange:function(e){N.emit("typing",{username:t}),v(e.target.value)}}),Object(l.jsx)("button",{className:"btn btn-primary",onClick:function(){v(""),N.emit("message",{content:p,username:t})},children:"Submit"})]})]})]})},f=n(22);var p=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(""),r=Object(o.a)(a,2),b=r[0],m=r[1];return Object(l.jsx)("div",{className:"App container pt-5",children:Object(l.jsx)(f.a,{children:Object(l.jsx)(j.Provider,{value:{usernames:[n,s],room:[b,m]},children:Object(l.jsxs)(i.c,{children:[Object(l.jsx)(i.a,{path:"/room",children:Object(l.jsx)(x,{})}),Object(l.jsx)(i.a,{path:"/",children:Object(l.jsx)(u,{})})]})})})})};r.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(p,{})}),document.getElementById("root"))}},[[91,1,2]]]);
//# sourceMappingURL=main.abbe8245.chunk.js.map